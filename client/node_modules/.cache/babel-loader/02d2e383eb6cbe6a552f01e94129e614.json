{"ast":null,"code":"var _jsxFileName = \"/Users/daniel/Desktop/Projects/FilmCritic/client/src/Components/Reviews/Reviews.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { addLike, removeLike, incrimentLike, decrimentLike } from \"../../features/movie/movieSlice\";\nimport Container from \"../Container/Container\";\nimport { addUserLike, removeUserLike } from './../../features/authentication/authSlice';\nimport { useDispatch, useSelector } from 'react-redux';\nimport './Reviews.css';\nimport { useMutation } from \"@apollo/client\";\nimport { CREATE_LIKE, DELETE_LIKE } from \"../../Graphql/Mutations\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Reviews = ({\n  className,\n  children,\n  style,\n  reviews\n}) => {\n  _s();\n\n  const user = useSelector(state => state.auth.user);\n  const isLoggedIn = useSelector(state => state.auth.isLoggedIn);\n  const dispatch = useDispatch();\n  const [likePost, {\n    error: likeError,\n    loading: likeLoading,\n    data: likeData\n  }] = useMutation(CREATE_LIKE);\n  const [unLikePost, {\n    error: unLikeError,\n    loading: unLikeLoading,\n    data: unLikeData\n  }] = useMutation(DELETE_LIKE);\n  const [userLikes, setUserLikes] = useState([]);\n  useEffect(() => {\n    if (likeData) {//dispatch(getUserLikes({ userId: user.id })).then((res, err) => {\n      //})\n    }\n  }, [likeData]);\n  useEffect(() => {\n    if (user !== null && user.hasOwnProperty(\"likedReviews\")) {\n      setUserLikes(user.likedReviews); //console.log(userLikes)\n    }\n  }, [user]);\n  useEffect(() => {\n    console.log(likeData.likePost); //var revIndex = (user.likedReviews.findIndex(review => review.id ==))\n\n    if (likeData) {//dispatch(incrimentLike({reviewId: \"\", like: likeData.likePost}));\n    }\n  }, [likeData]);\n\n  const onAddLike = async review => {\n    console.log(\"liked\");\n    var hasAlreadyReviewd = user.likedReviews.find(like => like.reviewId === review.id);\n\n    if (hasAlreadyReviewd) {\n      return console.log(user.likedReviews);\n    }\n\n    await likePost({\n      variables: {\n        reviewId: review.id,\n        userId: user.id\n      }\n    });\n  };\n\n  const onUnLike = async review => {\n    console.log(\"unliked\");\n    await unLikePost({\n      variables: {\n        reviewId: review.id,\n        userId: user.id\n      }\n    });\n\n    if (unLikeData) {\n      console.log(likeData); //dispatch(decrimentLike({revieweId: review.id, likeId: likeData}))\n    } // dispatch(removeLike({reviewId: review.id, userId: user.id})).then((res, err) => {\n    //     if (res) {\n    //         dispatch(removeUserLike(res.payload.result));\n    //         dispatch(decrimentLike(review.id));\n    //     }\n    // });\n\n  };\n\n  if (reviews.length <= 0) return;\n\n  const createdDate = mySqlDate => {\n    if (mySqlDate.length <= 0) return;\n    var date = new Date(parseInt(mySqlDate));\n    return date.getMonth() + 1 + \"/\" + date.getDate() + \"/\" + date.getUTCFullYear();\n  };\n\n  const createdTime = mySqlDate => {\n    if (mySqlDate.length <= 0) return;\n    var date = new Date(parseInt(mySqlDate));\n    return date.toLocaleTimeString();\n  };\n\n  const renderLikeButtons = review => {\n    if (!user.likedReviews) {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"btn-small pe-2 like-button\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-thumbs-up\",\n            \"aria-hidden\": \"true\",\n            style: {\n              fontSize: '20px',\n              color: 'rgba(29, 29, 35, 1)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 18\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }, this)\n      }, void 0, false);\n    } else if (user.likedReviews.length > 0) {\n      if (review) {\n        var hasAlreadyReviewed = review.likes.find(like => like.user.id === user.id);\n\n        if (hasAlreadyReviewed) {\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-small pe-2 like-button\",\n              onClick: () => onUnLike(review),\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-thumbs-up\",\n                \"aria-hidden\": \"true\",\n                style: {\n                  fontSize: '20px',\n                  color: 'rgba(225, 202, 240, 1)'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 107,\n                columnNumber: 26\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 25\n            }, this)\n          }, void 0, false);\n        }\n      }\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-small draw meet pe-2 like-button\",\n        onClick: () => {\n          onAddLike(review);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa fa-thumbs-o-up\",\n          \"aria-hidden\": \"true\",\n          style: {\n            fontSize: '20px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 14\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }, this)\n    }, void 0, false);\n  };\n\n  const renderReview = (review, indx) => {\n    var stars = [];\n\n    var color = () => {\n      if (review.entertainment >= 4) {\n        return 'green';\n      } else if (review.entertainment >= 2) {\n        return 'orange';\n      } else {\n        return 'red';\n      }\n    };\n\n    for (let i = 0; i < review.rating; i++) {\n      stars.push(i);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"py-2 pt-0\",\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        variant: \"shadow\",\n        className: \"my-1\",\n        style: {\n          padding: '1rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"me-auto my-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"btn-login draw meet me-2\",\n              children: review.author.firstName || review.author.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontSize: '12px',\n                color: 'black'\n              },\n              children: review.author.firstName && '@' + review.author.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex\",\n            children: stars.map(star => {\n              return /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa fa-star px-1 d-flex align-items-center\",\n                \"aria-hidden\": \"true\",\n                style: {\n                  color: color(),\n                  textShadow: '2px 2px black',\n                  transition: 'all 0.1s',\n                  fontSize: '20px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 49\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Container, {\n          style: {\n            padding: '0rem',\n            color: 'white'\n          },\n          children: review.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex gap-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex align-items-center gap-1\",\n            style: {\n              color: 'white',\n              fontSize: '12px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: review.likes.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fa fa-thumbs-up\",\n              \"aria-hidden\": \"true\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n          style: {\n            marginTop: '0.5rem',\n            marginBottom: '0.5rem'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-items-center\",\n          children: [renderLikeButtons(review), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-column ms-auto\",\n            style: {\n              fontSize: '12px',\n              color: 'black'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ms-auto\",\n              children: createdTime(review.created)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ms-auto\",\n              children: createdDate(review.created)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 29\n        }, this)]\n      }, indx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 25\n      }, this)\n    }, review.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 29\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: className,\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"py-0\",\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        color: 'white',\n        fontSize: '25px',\n        fontWeight: '500',\n        textShadow: '2px 2px rgba(80, 80, 100, 1)'\n      },\n      children: \"Lets hear from the Critics\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      style: {\n        padding: '0rem',\n        backgroundColor: 'none'\n      },\n      children: reviews.map((review, indx) => {\n        return renderReview(review, indx);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 215,\n    columnNumber: 13\n  }, this);\n};\n\n_s(Reviews, \"f/b1t1M7kF8j40iapoIQBZ4dlYI=\", false, function () {\n  return [useSelector, useSelector, useDispatch, useMutation, useMutation];\n});\n\n_c = Reviews;\nexport default Reviews;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reviews\");","map":{"version":3,"sources":["/Users/daniel/Desktop/Projects/FilmCritic/client/src/Components/Reviews/Reviews.js"],"names":["React","useEffect","useState","addLike","removeLike","incrimentLike","decrimentLike","Container","addUserLike","removeUserLike","useDispatch","useSelector","useMutation","CREATE_LIKE","DELETE_LIKE","Reviews","className","children","style","reviews","user","state","auth","isLoggedIn","dispatch","likePost","error","likeError","loading","likeLoading","data","likeData","unLikePost","unLikeError","unLikeLoading","unLikeData","userLikes","setUserLikes","hasOwnProperty","likedReviews","console","log","onAddLike","review","hasAlreadyReviewd","find","like","reviewId","id","variables","userId","onUnLike","length","createdDate","mySqlDate","date","Date","parseInt","getMonth","getDate","getUTCFullYear","createdTime","toLocaleTimeString","renderLikeButtons","fontSize","color","hasAlreadyReviewed","likes","renderReview","indx","stars","entertainment","i","rating","push","padding","author","firstName","username","map","star","textShadow","transition","description","marginTop","marginBottom","created","display","alignItems","fontWeight","backgroundColor"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { addLike, removeLike, incrimentLike, decrimentLike } from \"../../features/movie/movieSlice\";\nimport Container from \"../Container/Container\";\n\n import { \n    addUserLike,\n    removeUserLike\n } from './../../features/authentication/authSlice';\n import { useDispatch, useSelector } from 'react-redux';\n\nimport './Reviews.css';\nimport { useMutation } from \"@apollo/client\";\nimport { CREATE_LIKE, DELETE_LIKE } from \"../../Graphql/Mutations\";\n\nconst Reviews = ({ className, children  , style, reviews}) => {\n    const user = useSelector((state) => state.auth.user);\n    const isLoggedIn = useSelector((state) => state.auth.isLoggedIn);\n    const dispatch = useDispatch();\n    const [likePost, { error: likeError, loading: likeLoading, data: likeData }] = useMutation(CREATE_LIKE);\n    const [unLikePost, { error: unLikeError, loading: unLikeLoading, data: unLikeData }] = useMutation(DELETE_LIKE);\n    const [userLikes, setUserLikes] = useState([]);\n    useEffect(() => {\n        if (likeData) {\n            //dispatch(getUserLikes({ userId: user.id })).then((res, err) => {\n            //})\n        }\n\n    }, [likeData])\n\n    useEffect(() => {\n        if (user !== null && user.hasOwnProperty(\"likedReviews\")) {\n            setUserLikes(user.likedReviews)\n            //console.log(userLikes)\n        }\n    }, [user])\n\n    useEffect(() => {\n        console.log(likeData.likePost)\n        //var revIndex = (user.likedReviews.findIndex(review => review.id ==))\n        if (likeData) {\n            //dispatch(incrimentLike({reviewId: \"\", like: likeData.likePost}));\n        }\n\n    }, [likeData])\n\n    const onAddLike = async (review) => {\n        console.log(\"liked\")\n        var hasAlreadyReviewd = user.likedReviews.find(like => like.reviewId === review.id);\n        if (hasAlreadyReviewd) {\n            return console.log(user.likedReviews);\n        }        \n        await likePost({\n            variables: {reviewId: review.id, userId: user.id}\n        })\n    }\n\n    const onUnLike = async (review) => {\n        console.log(\"unliked\")\n        await unLikePost({\n            variables: {reviewId: review.id, userId: user.id}\n        })\n        if (unLikeData) {\n            console.log(likeData)\n            //dispatch(decrimentLike({revieweId: review.id, likeId: likeData}))\n        }\n        // dispatch(removeLike({reviewId: review.id, userId: user.id})).then((res, err) => {\n        //     if (res) {\n        //         dispatch(removeUserLike(res.payload.result));\n        //         dispatch(decrimentLike(review.id));\n        //     }\n\n        // });\n    }\n\n    if (reviews.length <=0) return;\n\n    const createdDate = (mySqlDate) => {\n        if (mySqlDate.length <= 0) return;\n        var date = new Date(parseInt(mySqlDate));\n        return (date.getMonth()+1)+\"/\"+date.getDate()+\"/\"+date.getUTCFullYear();\n    }\n\n    const createdTime = (mySqlDate) => {\n        if (mySqlDate.length <= 0) return;\n        var date = new Date(parseInt(mySqlDate));\n        return date.toLocaleTimeString();\n    }\n\n    const renderLikeButtons = (review) => {\n        \n        if (!(user.likedReviews)) {\n            return (<>\n                <div className=\"btn-small pe-2 like-button\"\n                ><i className=\"fa fa-thumbs-up\" aria-hidden=\"true\" style={{\n                    fontSize: '20px',\n                    color: 'rgba(29, 29, 35, 1)'\n                }}\n                ></i></div>\n            </>)\n        } else if (user.likedReviews.length > 0) {\n            if (review) {\n                var hasAlreadyReviewed = review.likes.find(like => like.user.id === user.id);\n                if (hasAlreadyReviewed) {\n                    return (<>\n                        <button className=\"btn-small pe-2 like-button\"\n                        onClick={() => onUnLike(review)}\n                        ><i className=\"fa fa-thumbs-up\" aria-hidden=\"true\" style={{\n                            fontSize: '20px',\n                            color: 'rgba(225, 202, 240, 1)'\n                        }}\n                        ></i></button>\n                    </>)\n                }\n            }\n           \n        }\n\n        return (<>\n            <button className=\"btn-small draw meet pe-2 like-button\"\n                onClick={() => {onAddLike(review)}}\n            ><i className=\"fa fa-thumbs-o-up\" aria-hidden=\"true\" style={{\n                fontSize: '20px',\n            }}\n            ></i></button>\n        </>)\n    }\n\n    const renderReview = (review, indx) => {\n                    var stars = [];\n                    var color = () => {\n                        if (review.entertainment >= 4) {\n                            return 'green';\n                        } else if (review.entertainment >= 2) {\n                            return 'orange';\n                        } else {\n                            return 'red';\n                        }\n                    }\n                    for (let i = 0; i < review.rating; i++) {\n                        stars.push(i);\n                    }\n\n                    return (<div className=\"py-2 pt-0\" key={review.id}>\n                        \n                        <Container variant=\"shadow\" key={indx} className='my-1' style={{\n                            padding: '1rem'\n                        }}>\n                            <div className='d-flex'>\n                                <div className=\"me-auto my-1\">\n                                    <button type=\"button\" className=\"btn-login draw meet me-2\">{review.author.firstName || review.author.username}</button>\n                                    <span style={{\n                                        fontSize: '12px',\n                                        color: 'black'\n                                    }}>{review.author.firstName && '@'+review.author.username}</span>\n                                </div>\n                                \n                                <div className=\"d-flex\">\n                                    {\n                                        stars.map((star) => {\n                                            return (\n                                                <i className=\"fa fa-star px-1 d-flex align-items-center\" aria-hidden=\"true\" style={{\n                                                    color:  color(),\n                                                    textShadow: '2px 2px black',\n                                                    transition: 'all 0.1s',\n                                                    fontSize: '20px'\n                                                }}></i>\n                                            )\n                                        })\n                                    }\n                                </div>\n                            </div>\n                            \n                            <Container style={{\n                                padding: '0rem',\n                                color: 'white'\n                            }}>\n                                {review.description}\n                            </Container>\n\n                            <div className=\"d-flex gap-2\">\n                                <div className=\"d-flex align-items-center gap-1\" style={{\n                                    color: 'white',\n                                    fontSize: '12px',\n                                }}>\n                                    <span>{review.likes.length}</span>\n                                    <i className=\"fa fa-thumbs-up\" aria-hidden=\"true\"></i>\n                                </div>\n                            </div>\n\n                            \n\n                            <hr style={{\n                                marginTop: '0.5rem',\n                                marginBottom: '0.5rem'\n                            }}/>\n\n                            <div className=\"d-flex align-items-center\">\n                                {renderLikeButtons(review)}\n\n                                <div className=\"d-flex flex-column ms-auto\" style={{\n                                        fontSize: '12px',\n                                        color: 'black',\n                                    }}>\n                                    <span className=\"ms-auto\">{createdTime(review.created)}</span>\n                                    <span className=\"ms-auto\">{createdDate(review.created)}</span>\n                                </div>\n                            </div>\n\n                            \n                        </Container>\n                    </div>)\n    }\n\n\n    return (<div className={className}>\n        <span className=\"py-0\" style={{\n            display: 'flex',\n            alignItems: 'center',\n            color: 'white',\n            fontSize: '25px',\n            fontWeight: '500',\n            textShadow: '2px 2px rgba(80, 80, 100, 1)',\n        }}>\n            Lets hear from the Critics\n        </span>\n        <Container style={{\n            padding: '0rem',\n            backgroundColor: 'none'\n        }}>\n            \n            {\n                reviews.map((review, indx) => {\n                    return renderReview(review, indx); \n                })\n            }\n        </Container>\n   </div> )\n\n}\n\nexport default Reviews;"]},"metadata":{},"sourceType":"module"}