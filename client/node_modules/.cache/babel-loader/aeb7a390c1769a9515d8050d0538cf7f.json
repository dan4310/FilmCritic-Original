{"ast":null,"code":"import axios from 'axios';\nimport { createSlice, createAsyncThunk, current } from '@reduxjs/toolkit';\nexport const addLike = createAsyncThunk('review/addLike', async ({\n  reviewId,\n  userId,\n  likeDate\n}) => {\n  return await axios.post(\"http://localhost:3001/addLike\", {\n    reviewId: reviewId,\n    likerId: userId,\n    likeDate: likeDate\n  }).then((response, err) => {\n    if (response.data.success === false) {\n      console.log(response.data.message);\n      return null;\n    } else {\n      return response.data;\n    }\n  });\n});\nexport const removeLike = createAsyncThunk('review/removeLike', async ({\n  reviewId,\n  userId\n}) => {\n  return await axios.post(\"http://localhost:3001/removeLike\", {\n    reviewId: reviewId,\n    likerId: userId\n  }).then((response, err) => {\n    if (response.data.success === false) {\n      console.log(response.data.message);\n      return null;\n    } else {\n      return response.data;\n    }\n  });\n});\nexport const movieSlice = createSlice({\n  name: 'movie',\n  initialState: {\n    isLoading: true,\n    movieInfo: {},\n    reviews: []\n  },\n  reducers: {\n    addReview: (state, action) => {\n      var temp = current(state).reviews;\n      temp = [...temp, action.payload];\n      state.reviews = temp;\n    },\n    setReviews: (state, action) => {\n      state.reviews = action.payload;\n    },\n    incrimentLike: (state, action) => {\n      var reviewId = action.payload.reviewId;\n      var like = action.payload.like;\n      var temp = current(state);\n      var index = temp.reviews.findIndex(review => review.id === reviewId);\n      temp = temp.reviews[index].likes;\n      temp = [...temp, { ...like\n      }];\n      state.reviews[index].likes = temp;\n    },\n    decrimentLike: (state, action) => {\n      var reviewId = action.payload.reviewId;\n      var likeId = action.payload.likeId;\n      var temp = current(state);\n      var reviewIndex = temp.reviews.findIndex(review => review.id === reviewId);\n      var likeIndex = temp.reviews[reviewIndex].likes.findIndex(like => like.id === likeId);\n\n      if (reviewIndex >= 0 && likeIndex >= 0) {\n        console.log(temp.reviews[reviewIndex].likes);\n        temp.reviews[reviewIndex].likes.splice(likeIndex, 1); // state.reviews = temp.reviews;\n      }\n    }\n  },\n  extraReducers: {\n    [addLike.fulfilled]: (state, action) => {\n      if (action.payload) {\n        state.reviews.forEach((review, indx) => {\n          if (review.id === action.payload.reviewId) {\n            state.reviews[indx].likes += 1;\n          }\n        });\n      }\n    }\n  }\n});\nexport const {\n  addReview,\n  setReviews,\n  incrimentLike,\n  decrimentLike\n} = movieSlice.actions;\nexport default movieSlice.reducer;","map":{"version":3,"sources":["/Users/daniel/Desktop/Projects/FilmCritic/client/src/features/movie/movieSlice.js"],"names":["axios","createSlice","createAsyncThunk","current","addLike","reviewId","userId","likeDate","post","likerId","then","response","err","data","success","console","log","message","removeLike","movieSlice","name","initialState","isLoading","movieInfo","reviews","reducers","addReview","state","action","temp","payload","setReviews","incrimentLike","like","index","findIndex","review","id","likes","decrimentLike","likeId","reviewIndex","likeIndex","splice","extraReducers","fulfilled","forEach","indx","actions","reducer"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport { createSlice, createAsyncThunk, current } from '@reduxjs/toolkit';\n\nexport const addLike = createAsyncThunk('review/addLike', async ({ reviewId, userId, likeDate }) => {\n    return await axios.post(\"http://localhost:3001/addLike\", {\n        reviewId: reviewId,\n        likerId: userId,\n        likeDate: likeDate,\n    }).then((response, err) => {\n        if (response.data.success === false) {\n            console.log(response.data.message);\n            return null;\n        } else {\n            return response.data;\n        }\n    })\n});\n\nexport const removeLike = createAsyncThunk('review/removeLike', async ({ reviewId, userId }) => {\n    return await axios.post(\"http://localhost:3001/removeLike\", {\n        reviewId: reviewId,\n        likerId: userId\n    }).then((response, err) => {\n        if (response.data.success === false) {\n            console.log(response.data.message);\n            return null;\n        } else {\n            return response.data;\n        }\n    })\n});\n\nexport const movieSlice = createSlice({\n    name: 'movie',\n    initialState: {\n        isLoading: true,\n        movieInfo: {\n            \n        },\n        reviews: []\n    },\n    reducers: {\n        addReview: (state, action) => {\n            var temp = current(state).reviews;\n            temp = [...temp, action.payload];\n            state.reviews = temp;\n        },\n        setReviews: (state, action) => {\n            state.reviews = action.payload;\n        },\n        incrimentLike: (state, action) => {\n            var reviewId = action.payload.reviewId;\n            var like = action.payload.like;\n\n            var temp = current(state)\n            var index = temp.reviews.findIndex(review => review.id === reviewId)\n            temp = temp.reviews[index].likes;\n            temp = [...temp,{...like}];\n            state.reviews[index].likes = temp;\n        },\n        decrimentLike: (state, action) => {\n            var reviewId = action.payload.reviewId;\n            var likeId = action.payload.likeId;\n            var temp = current(state);\n\n            var reviewIndex = temp.reviews.findIndex(review => review.id === reviewId);\n            var likeIndex = temp.reviews[reviewIndex].likes.findIndex(like => like.id === likeId);\n\n            if (reviewIndex >= 0 && likeIndex >= 0) {\n                console.log(temp.reviews[reviewIndex].likes);  \n                temp.reviews[reviewIndex].likes.splice(likeIndex, 1);\n                // state.reviews = temp.reviews;\n            }\n        },\n    },\n    extraReducers: {\n        [addLike.fulfilled]: (state, action) => {\n            if (action.payload) {\n                state.reviews.forEach((review, indx) => {\n                    if (review.id === action.payload.reviewId) {\n                        state.reviews[indx].likes += 1;\n                    }\n                })\n            }\n        }\n        \n    }\n});\n\nexport const { addReview, setReviews, incrimentLike, decrimentLike } = movieSlice.actions;\n\n\n\n\nexport default movieSlice.reducer;"]},"metadata":{},"sourceType":"module"}